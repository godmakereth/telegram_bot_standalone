# 📖 RG Telegram 廣播系統 - 操作說明

## 🚀 快速入門

### 第一次啟動

1. **安裝依賴**
   ```bash
   pip install -r requirements.txt
   ```

2. **啟動系統**
   ```bash
   python working_gui.py
   ```

3. **設定 API 資訊**
   - 在「🔗 連接設定」標籤頁輸入 Telegram API 資訊
   - 點擊「🔗 連接Telegram」完成驗證

## 🖥️ GUI 界面完整操作指南

### 📋 界面總覽

主界面分為四個主要標籤頁：
- 🔗 **連接設定** - Telegram 連接管理
- 📡 **廣播控制** - 廣播操作和排程管理  
- ⚙️ **系統管理** - 群組和內容管理
- 📋 **系統狀態** - 監控和日誌查看

---

## 🔗 連接設定頁面

### 功能區域

#### 📊 連接狀態顯示
- **狀態指示**: 即時顯示 Telegram 連接狀態
  - ✅ 綠色：已連接
  - ❌ 紅色：未連接
  - ⚠️ 黃色：連接中

#### 🔧 連接控制按鈕
| 按鈕 | 功能 | 說明 |
|------|------|------|
| 🔗 連接Telegram | 建立連接 | 使用配置的 API 資訊連接 Telegram |
| 🔌 斷開連接 | 斷開連接 | 安全斷開 Telegram 連接 |
| 🔄 重新載入配置 | 重載配置 | 重新讀取所有配置文件 |

#### ⚙️ API 設定資訊
- 顯示當前配置的 API ID、API Hash、手機號碼
- 此區域僅供查看，修改需編輯配置文件

### 操作步驟

1. **首次連接**
   ```
   1. 確認 API 資訊已正確配置
   2. 點擊「🔗 連接Telegram」
   3. 輸入手機驗證碼（如果需要）
   4. 等待連接狀態變為綠色
   ```

2. **重新連接**
   ```
   1. 點擊「🔌 斷開連接」
   2. 等待狀態變為紅色
   3. 點擊「🔗 連接Telegram」
   4. 確認連接成功
   ```

---

## 📡 廣播控制頁面

### 🚀 手動廣播區域

#### 活動選擇下拉選單
- 選擇要廣播的活動（A、B、C、D、E）
- 顯示每個活動的內容摘要

#### 操作按鈕詳解
| 按鈕 | 功能 | 操作說明 |
|------|------|----------|
| 🚀 立即廣播 | 執行廣播 | 立即向所有目標群組廣播選定活動 |
| 👁️ 預覽內容 | 內容預覽 | 查看活動內容和目標群組列表 |
| 🧪 測試廣播 | 測試功能 | 模擬廣播流程，不實際發送 |
| 🔄 刷新活動 | 重載活動 | 重新掃描並載入活動內容 |

#### 廣播操作流程
```
1. 選擇活動 → 2. 預覽內容 → 3. 執行廣播 → 4. 查看結果
```

### ⏰ 排程控制區域

#### 排程狀態顯示
- **啟用狀態**: 顯示自動排程是否已啟用
- **下次執行**: 顯示下一個預定執行的排程
- **今日執行**: 顯示今天已執行的排程數量

#### 排程管理按鈕
| 按鈕 | 功能 | 操作說明 |
|------|------|----------|
| ☑️ 啟用自動排程 | 開關排程 | 啟用或停用自動排程功能 |
| 📅 查看排程 | 排程列表 | 顯示所有已設定的排程 |
| ➕ 新增排程 | 添加排程 | 添加新的定時廣播排程 |
| ➖ 移除排程 | 刪除排程 | 選擇性移除現有排程 |
| 🔄 重新載入 | 刷新狀態 | 重新載入排程配置和狀態 |

#### 新增排程操作
```
1. 點擊「➕ 新增排程」
2. 設定執行時間（格式：HH:MM）
3. 選擇廣播活動（A-E）
4. 確認添加
5. 檢查排程列表
```

#### 移除排程操作
```
1. 點擊「➖ 移除排程」
2. 從列表中選擇要刪除的排程
3. 確認移除
4. 檢查排程列表更新
```

---

## ⚙️ 系統管理頁面

### 👥 群組管理區域

#### 群組資訊顯示
- **群組列表**: 顯示所有已配置的廣播目標群組
- **群組數量**: 統計當前配置的群組總數
- **群組狀態**: 顯示每個群組的狀態和類型

#### 群組管理按鈕
| 按鈕 | 功能 | 操作說明 |
|------|------|----------|
| ➕ 添加群組 | 新增群組 | 將群組添加為廣播目標 |
| ➖ 移除群組 | 刪除群組 | 從廣播目標中移除群組 |
| 📋 管理群組 | 批量管理 | 開啟群組管理對話框 |
| 🔄 重新載入 | 刷新列表 | 重新載入群組配置 |
| 🌐 掃描群組 | 群組掃描 | 掃描機器人已加入的所有群組 |
| 📊 群組詳情 | 詳細資訊 | 顯示群組的詳細資訊 |

#### 群組掃描功能
```
功能：自動掃描機器人已加入的所有群組
操作：
1. 點擊「🌐 掃描群組」
2. 等待掃描完成
3. 查看掃描結果
4. 選擇需要的群組添加為目標
```

#### 群組管理對話框
```
功能：批量管理廣播目標群組
操作：
1. 點擊「📋 管理群組」
2. 在對話框中：
   - 查看所有群組列表
   - 勾選/取消廣播目標
   - 設定控制群組
3. 點擊「確定」保存變更
```

### 📁 活動內容區域

#### 內容摘要顯示
- 顯示所有活動（A-E）的內容摘要
- 包含文字長度、媒體文件數量等資訊
- 標示內容完整性狀態

#### 內容管理按鈕
| 按鈕 | 功能 | 操作說明 |
|------|------|----------|
| 🔄 重新載入內容 | 刷新內容 | 重新掃描並載入所有活動內容 |

#### 內容資料夾結構
```
data/content_databases/
├── A/                  # 活動 A
│   ├── message.txt     # 必要：文字內容
│   ├── image1.jpg      # 可選：圖片文件
│   ├── video.mp4       # 可選：影片文件
│   └── animation.gif   # 可選：GIF 文件
├── B/                  # 活動 B
├── C/                  # 活動 C
├── D/                  # 活動 D
└── E/                  # 活動 E
```

---

## 📋 系統狀態頁面

### 📊 即時日誌顯示

#### 日誌資訊
- **即時更新**: 自動顯示最新的系統日誌
- **多種類型**: 包含資訊、警告、錯誤等不同級別
- **時間戳記**: 每條日誌都包含精確的時間資訊

#### 日誌管理按鈕
| 按鈕 | 功能 | 操作說明 |
|------|------|----------|
| 🗑️ 清空日誌 | 清空顯示 | 清空當前顯示的日誌內容 |
| 💾 保存日誌 | 導出日誌 | 將當前日誌保存到文件 |
| 🔄 系統重啟 | 重啟系統 | 重新啟動整個廣播系統 |

#### 日誌查看技巧
```
1. 滾動查看：使用滾動條查看歷史日誌
2. 狀態監控：關注錯誤和警告訊息
3. 廣播追蹤：查看廣播執行過程
4. 排程監控：確認排程執行狀態
```

---

## 🤖 Telegram 指令操作

### 📱 在控制群組中使用指令

#### 基本系統指令
```bash
/help           # 顯示所有可用指令
/status         # 查看系統狀態
/restart        # 重啟機器人系統
/config         # 顯示當前配置
/logs 10        # 顯示最近 10 條日誌
```

#### 快速廣播指令
```bash
/q A            # 快速廣播活動 A
/q B            # 快速廣播活動 B
/broadcast C    # 廣播活動 C（完整指令）
/bc D           # 廣播活動 D（縮寫）
```

#### 群組管理指令
```bash
# 查看群組
/list_groups    # 列出所有廣播群組
/lg             # 縮寫形式
/scan_groups    # 掃描所有群組
/sg             # 縮寫形式

# 添加群組
/add_groups     # 互動式添加
/add_groups -1001234567890  # 直接添加指定 ID

# 移除群組
/remove_groups  # 互動式移除
/remove_groups -1001234567890  # 直接移除指定 ID
```

#### 排程管理指令
```bash
# 添加排程
/add_schedule 09:00 A    # 9點廣播活動 A
/as 15:30 B             # 15:30 廣播活動 B（縮寫）

# 查看排程
/list_schedules         # 列出所有排程
/ls                     # 縮寫形式

# 移除排程
/remove_schedule        # 互動式移除
/remove_schedule 1      # 移除編號 1 的排程

# 排程控制
/enable                 # 啟用自動排程
/disable                # 停用自動排程
```

#### 管理員管理指令
```bash
/add_admin 123456789    # 添加管理員（用戶 ID）
/remove_admin 123456789 # 移除管理員
/list_admins           # 列出所有管理員
/sync_admins           # 同步管理員列表
```

### 📞 指令使用技巧

#### 1. 獲取群組 ID
```
方法一：機器人掃描
1. 將機器人加入目標群組
2. 使用 /scan_groups 指令
3. 從結果中找到群組 ID

方法二：轉發訊息
1. 轉發群組訊息給機器人
2. 機器人會回覆群組 ID
```

#### 2. 批量操作
```
添加多個群組：
/add_groups
然後依次輸入群組 ID，用換行分隔

添加多個排程：
/as 09:00 A
/as 12:00 B  
/as 18:00 C
```

#### 3. 錯誤處理
```
指令沒有回應：
1. 確認在控制群組中使用
2. 檢查管理員權限
3. 確認機器人在線

廣播失敗：
1. 檢查群組權限
2. 確認機器人仍在群組中
3. 查看錯誤日誌
```

---

## 🔧 高級操作

### 📊 監控與維護

#### 系統健康檢查
```
檢查項目：
1. Telegram 連接狀態
2. 排程器運行狀態
3. 廣播歷史記錄
4. 錯誤日誌分析
5. 配置文件完整性
```

#### 定期維護任務
```
每日：
- 檢查廣播執行情況
- 查看錯誤日誌
- 確認排程狀態

每週：
- 備份配置文件
- 清理舊日誌文件
- 檢查群組狀態

每月：
- 更新管理員列表
- 檢查內容資料夾
- 性能分析
```

### 🚨 故障處理

#### 常見問題解決

**問題：無法連接 Telegram**
```
解決步驟：
1. 檢查網路連接
2. 確認 API 資訊正確
3. 檢查防火牆設定
4. 重新啟動系統
```

**問題：排程沒有執行**
```
檢查清單：
✓ 排程是否已啟用（/enable）
✓ 系統時間是否正確
✓ 機器人是否在線
✓ 活動內容是否存在
✓ 目標群組是否有效
```

**問題：廣播發送失敗**
```
排查步驟：
1. 確認機器人在目標群組中
2. 檢查群組發送權限
3. 驗證內容文件存在
4. 查看詳細錯誤訊息
5. 測試單個群組發送
```

**問題：GUI 界面異常**
```
處理方法：
1. 重新啟動 GUI
2. 檢查配置文件
3. 重新載入配置
4. 清除緩存文件
5. 重新安裝依賴
```

### 🔄 備份與恢復

#### 重要文件備份
```
需要備份的文件：
- data/settings.json
- data/broadcast_config.json  
- data/admins.json
- data/broadcast_history.json
- userbot.session
- data/content_databases/
```

#### 系統恢復步驟
```
1. 停止所有程序
2. 恢復備份文件
3. 重新啟動系統
4. 檢查連接狀態
5. 驗證配置正確性
6. 測試基本功能
```

---

## 📈 最佳實踐建議

### 🎯 廣播策略

#### 內容準備
```
1. 文字內容：
   - 保持簡潔明瞭
   - 避免特殊字符
   - 控制長度適中

2. 媒體文件：
   - 圖片：建議 1920x1080 以下
   - 影片：建議 50MB 以下
   - 格式：使用常見格式（JPG、MP4）
```

#### 排程規劃
```
1. 避開高峰時段：
   - 避免午餐時間（12:00-13:00）
   - 避免下班時間（17:00-19:00）

2. 合理間隔：
   - 同一群組間隔至少 30 分鐘
   - 不同活動錯開時間

3. 備用時段：
   - 設定備用排程時間
   - 準備緊急廣播方案
```

### 🔐 安全管理

#### 權限控制
```
1. 管理員設定：
   - 定期檢查管理員列表
   - 移除離職人員權限
   - 使用最小權限原則

2. 群組管理：
   - 定期檢查群組狀態
   - 移除無效群組
   - 監控群組權限變化
```

#### 資料保護
```
1. 敏感資訊：
   - 不在配置文件中存放密碼
   - 定期更新 API 金鑰
   - 保護 session 文件

2. 日誌管理：
   - 定期清理敏感日誌
   - 控制日誌文件大小
   - 設定適當的日誌級別
```

---

這份操作說明涵蓋了系統的所有主要功能和使用方法，無論是 GUI 操作還是 Telegram 指令，都能幫助用戶快速上手並有效管理廣播系統。